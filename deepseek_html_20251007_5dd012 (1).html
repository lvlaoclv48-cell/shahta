<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FaidikApp</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: #000;
            color: #fff;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        .header {
            width: 100%;
            background: #111;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 25px;
            border-bottom: 2px solid #333;
        }
        
        .logo {
            font-size: 2.2rem;
            font-weight: bold;
            color: #fff;
            text-align: center;
        }
        
        .logo span {
            color: #4CAF50;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 25px;
            flex: 1;
        }
        
        .search-section {
            background: #111;
            border-radius: 15px;
            padding: 35px;
            margin-bottom: 30px;
            border: 1px solid #333;
        }
        
        .input-group {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .phone-input {
            padding: 18px;
            font-size: 1.1rem;
            background: #222;
            border: 1px solid #444;
            border-radius: 8px;
            color: #fff;
            outline: none;
            width: 100%;
            transition: all 0.3s;
        }
        
        .phone-input:focus {
            border-color: #4CAF50;
            box-shadow: 0 0 0 2px rgba(76, 175, 80, 0.2);
        }
        
        .search-type {
            display: flex;
            gap: 12px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }
        
        .search-type-btn {
            flex: 1;
            padding: 14px;
            background: #222;
            border: 1px solid #444;
            border-radius: 8px;
            color: #aaa;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            min-width: 130px;
        }
        
        .search-type-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        
        .search-type-btn.active {
            background: #333;
            color: #fff;
            border-color: #4CAF50;
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
        }
        
        .search-btn {
            padding: 18px;
            background: #333;
            border: none;
            border-radius: 8px;
            color: #fff;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s;
            width: 100%;
            font-weight: bold;
            margin-bottom: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .search-btn:hover {
            background: #444;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }
        
        .search-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .action-buttons {
            display: flex;
            gap: 12px;
            margin-top: 25px;
        }
        
        .action-btn {
            flex: 1;
            padding: 14px;
            background: #222;
            border: 1px solid #444;
            border-radius: 8px;
            color: #fff;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        
        .action-btn:hover {
            background: #333;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        
        .action-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        .results {
            margin-top: 25px;
        }
        
        .result-item {
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 15px;
            border: 1px solid #333;
            transition: all 0.3s;
        }
        
        .result-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.2);
        }
        
        .valid {
            background: #1a3c1a;
            color: #4CAF50;
            border-color: #2E7D32;
        }
        
        .invalid {
            background: #3c1a1a;
            color: #F44336;
            border-color: #C62828;
        }
        
        .error {
            background: #3c3c1a;
            color: #FFC107;
            border-color: #FF8F00;
        }
        
        .checking {
            background: #2a2a2a;
            color: #aaa;
        }
        
        .service-name {
            font-size: 0.9rem;
            color: #ccc;
            font-weight: normal;
        }
        
        .status {
            font-weight: bold;
            font-size: 1.1rem;
        }
        
        .footer {
            background: #111;
            padding: 25px 0;
            text-align: center;
            margin-top: 40px;
            color: #666;
            font-size: 0.9rem;
            border-top: 2px solid #333;
        }
        
        .total-result {
            text-align: center;
            padding: 25px;
            margin-top: 25px;
            border-radius: 10px;
            font-size: 1.3rem;
            font-weight: bold;
            display: none;
        }
        
        .total-valid {
            background: #1a3c1a;
            color: #4CAF50;
            border: 1px solid #2E7D32;
        }
        
        .total-invalid {
            background: #3c1a1a;
            color: #F44336;
            border: 1px solid #C62828;
        }
        
        .api-result {
            background: #1a1a3c;
            color: #fff;
            border: 1px solid #333;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 15px;
        }
        
        .result-data {
            margin-top: 15px;
            padding: 15px;
            background: #2a2a4a;
            border-radius: 8px;
            border: 1px solid #444;
        }
        
        .info-line {
            display: flex;
            justify-content: space-between;
            margin: 8px 0;
            padding: 5px 0;
            border-bottom: 1px solid #444;
        }
        
        .info-label {
            color: #aaa;
            font-weight: 500;
        }
        
        .info-value {
            color: #fff;
            font-weight: bold;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: #333;
            border-radius: 3px;
            margin-top: 15px;
            overflow: hidden;
        }

        .progress {
            height: 100%;
            background: #4CAF50;
            width: 0%;
            transition: width 0.4s;
            border-radius: 3px;
        }

        .api-counter {
            text-align: center;
            color: #666;
            font-size: 0.9rem;
            margin-top: 10px;
        }

        .section-title {
            color: #4CAF50;
            margin: 15px 0 10px 0;
            font-weight: bold;
            font-size: 1.1rem;
        }

        .json-container {
            background: #1a1a2a;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border: 1px solid #444;
            max-height: 400px;
            overflow-y: auto;
        }

        .json-item {
            background: #2a2a3a;
            border-radius: 6px;
            padding: 12px;
            margin: 8px 0;
            border-left: 4px solid #4CAF50;
        }

        .json-field {
            display: flex;
            margin: 4px 0;
            padding: 2px 0;
        }

        .json-key {
            color: #4CAF50;
            font-weight: bold;
            min-width: 120px;
        }

        .json-value {
            color: #fff;
            flex: 1;
        }

        .database-badge {
            background: #FF9800;
            color: #000;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: bold;
            margin-left: 10px;
        }

        .leak-item {
            background: #3a1a1a;
            border-left: 4px solid #F44336;
        }

        .social-item {
            background: #1a3a3a;
            border-left: 4px solid #00BCD4;
        }

        .finance-item {
            background: #2a3a1a;
            border-left: 4px solid #8BC34A;
        }

        @media print {
            body * {
                visibility: hidden;
            }
            .results, .results * {
                visibility: visible;
            }
            .results {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
            }
            .action-buttons, .search-section {
                display: none;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .search-section {
                padding: 25px;
            }
            
            .search-type {
                flex-direction: column;
            }
            
            .search-type-btn {
                min-width: auto;
            }
            
            .json-field {
                flex-direction: column;
            }
            
            .json-key {
                min-width: auto;
                margin-bottom: 4px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo">Faidik<span>App</span></div>
    </div>
    
    <div class="container">
        <div class="search-section">
            <div class="input-group">
                <input type="text" class="phone-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: +79161234567)" id="phoneInput">
                
                <div class="search-type">
                    <button class="search-type-btn active" data-type="validity">–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –≤–∞–ª–∏–¥</button>
                    <button class="search-type-btn" data-type="api">–ü–æ–∏—Å–∫ –ø–æ API</button>
                    <button class="search-type-btn" data-type="freeapi">–ü–æ–∏—Å–∫ –ø–æ FREEAPI</button>
                </div>
                
                <button class="search-btn" id="searchBtn">–ü–†–û–í–ï–†–ò–¢–¨</button>
                
                <div class="progress-bar">
                    <div class="progress" id="progressBar"></div>
                </div>
                
                <div class="api-counter" id="apiCounter"></div>
                
                <div class="action-buttons">
                    <button class="action-btn" id="printBtn">üñ®Ô∏è –ü–µ—á–∞—Ç—å</button>
                    <button class="action-btn" id="downloadBtn">üì• –°–∫–∞—á–∞—Ç—å TXT</button>
                </div>
            </div>
            
            <div class="results" id="results">
                <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
            
            <div class="total-result" id="totalResult"></div>
        </div>
    </div>
    
    <div class="footer">
        <p>–í–µ—á–Ω–∞—è —Å—Å—ã–ª–∫–∞: FaidikSearch.xyz</p>
    </div>

    <script>
        // –¢–µ–∫—É—â–∏–π –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ç–∏–ø –ø–æ–∏—Å–∫–∞
        let currentSearchType = 'validity';
        let currentSearchInProgress = false;
        
        // –û—Å–Ω–æ–≤–Ω–æ–π DepSearch API
        const DEPSEARCH_API = {
            name: "DepSearch API",
            url: (phone) => `https://api.depsearch.digital/quest=${phone}?token=03IuH83d9BntICttmi0cVMFGicb6gi4h`,
            process: (data) => {
                console.log("Raw DepSearch Data:", data);
                return data; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
            }
        };

        // –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ API –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–æ–º–µ—Ä–æ–≤
        const FREE_PHONE_APIS = [
            {
                name: "AbstractAPI Phone Validation",
                url: (phone) => `https://phonevalidation.abstractapi.com/v1/?api_key=demokey&phone=${phone}`,
                process: (data) => ({
                    valid: data.valid ? '‚úÖ –î–∞' : '‚ùå –ù–µ—Ç',
                    number: data.number || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ',
                    format: data.format?.international || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ',
                    country: data.country?.name || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ',
                    location: data.location || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ',
                    carrier: data.carrier || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ',
                    line_type: data.type || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'
                })
            },
            {
                name: "NumVerify API",
                url: (phone) => `http://apilayer.net/api/validate?access_key=free&number=${phone}`,
                process: (data) => ({
                    valid: data.valid ? '‚úÖ –î–∞' : '‚ùå –ù–µ—Ç',
                    number: data.number || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ',
                    country: data.country_name || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ',
                    location: data.location || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ',
                    carrier: data.carrier || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ',
                    line_type: data.line_type || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'
                })
            },
            {
                name: "HackerTarget Lookup",
                url: (phone) => `https://api.hackertarget.com/phonenumberlookup/?q=${phone}`,
                process: (data) => ({
                    result: data.includes('error') ? '–û—à–∏–±–∫–∞ API' : data.substring(0, 200) + '...'
                })
            },
            {
                name: "AbstractAPI Demo",
                url: (phone) => `https://phonevalidation.abstractapi.com/v1/?api_key=DEMO&phone=${phone}`,
                process: (data) => ({
                    valid: data.valid ? '‚úÖ –î–∞' : '‚ùå –ù–µ—Ç',
                    number: data.number || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ',
                    country: data.country?.name || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ',
                    carrier: data.carrier || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ',
                    line_type: data.type || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'
                })
            },
            {
                name: "VeriPhone API",
                url: (phone) => `https://api.veriphone.io/v2/verify?phone=${phone}`,
                process: (data) => ({
                    valid: data.phone_valid ? '‚úÖ –î–∞' : '‚ùå –ù–µ—Ç',
                    number: data.phone || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ',
                    country: data.country || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ',
                    carrier: data.carrier || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ',
                    line_type: data.phone_type || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'
                })
            }
        ];

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∫—Ä–∞—Å–∏–≤–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è JSON –¥–∞–Ω–Ω—ã—Ö –∏–∑ DepSearch
        function renderDepSearchData(data) {
            let html = `
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <span style="font-weight: bold; font-size: 1.1rem;">${DEPSEARCH_API.name}</span>
                    <span class="status" style="color: #4CAF50;">–£–°–ü–ï–•</span>
                </div>
                <div class="result-data">
            `;

            // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—è
            if (data.phone || data.number) {
                html += `<div class="section-title">üì± –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</div>`;
                html += createInfoLine('–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞', data.phone || data.number);
            }

            if (data.status) {
                html += createInfoLine('–°—Ç–∞—Ç—É—Å', data.status);
            }

            if (data.valid !== undefined) {
                html += createInfoLine('–í–∞–ª–∏–¥–Ω–æ—Å—Ç—å', data.valid ? '‚úÖ –î–∞' : '‚ùå –ù–µ—Ç');
            }

            // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (results)
            if (data.results && Array.isArray(data.results)) {
                html += `<div class="section-title">üìä –ù–∞–π–¥–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:</div>`;
                html += `<div class="json-container">`;
                
                data.results.forEach((result, index) => {
                    const itemClass = getItemClass(result.data);
                    html += `
                        <div class="json-item ${itemClass}">
                            <div style="display: flex; align-items: center; margin-bottom: 8px;">
                                <strong>–ó–∞–ø–∏—Å—å ${index + 1}</strong>
                                <span class="database-badge">${result.data || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</span>
                            </div>
                    `;
                    
                    // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –ø–æ–ª—è –∑–∞–ø–∏—Å–∏
                    for (const [key, value] of Object.entries(result)) {
                        if (key !== 'data') {
                            const formattedValue = formatJsonValue(key, value);
                            if (formattedValue) {
                                html += `
                                    <div class="json-field">
                                        <span class="json-key">${formatKey(key)}:</span>
                                        <span class="json-value">${formattedValue}</span>
                                    </div>
                                `;
                            }
                        }
                    }
                    
                    html += `</div>`;
                });
                
                html += `</div>`;
            }

            // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –¥—Ä—É–≥–∏–µ –º–∞—Å—Å–∏–≤—ã
            const arrayFields = ['leaks', 'social_media', 'financial_data', 'additional_info'];
            arrayFields.forEach(field => {
                if (data[field] && Array.isArray(data[field])) {
                    html += `<div class="section-title">${getArrayTitle(field)}:</div>`;
                    html += `<div class="json-container">`;
                    
                    data[field].forEach((item, index) => {
                        html += `
                            <div class="json-item ${getItemClass(field)}">
                                <strong>${getArrayItemTitle(field)} ${index + 1}</strong>
                        `;
                        
                        if (typeof item === 'object') {
                            for (const [key, value] of Object.entries(item)) {
                                const formattedValue = formatJsonValue(key, value);
                                if (formattedValue) {
                                    html += `
                                        <div class="json-field">
                                            <span class="json-key">${formatKey(key)}:</span>
                                            <span class="json-value">${formattedValue}</span>
                                        </div>
                                    `;
                                }
                            }
                        } else {
                            html += `
                                <div class="json-field">
                                    <span class="json-value">${formatJsonValue(field, item)}</span>
                                </div>
                            `;
                        }
                        
                        html += `</div>`;
                    });
                    
                    html += `</div>`;
                }
            });

            // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –æ–¥–∏–Ω–æ—á–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã
            const objectFields = ['user_info', 'operator_info', 'location_info', 'risk_assessment'];
            objectFields.forEach(field => {
                if (data[field] && typeof data[field] === 'object') {
                    html += `<div class="section-title">${formatKey(field)}:</div>`;
                    html += `<div class="json-container">`;
                    html += `<div class="json-item">`;
                    
                    for (const [key, value] of Object.entries(data[field])) {
                        const formattedValue = formatJsonValue(key, value);
                        if (formattedValue) {
                            html += `
                                <div class="json-field">
                                    <span class="json-key">${formatKey(key)}:</span>
                                    <span class="json-value">${formattedValue}</span>
                                </div>
                            `;
                        }
                    }
                    
                    html += `</div></div>`;
                }
            });

            html += `</div>`;
            return html;
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–ª–∞—Å—Å–∞ —ç–ª–µ–º–µ–Ω—Ç–∞ –ø–æ —Ç–∏–ø—É –¥–∞–Ω–Ω—ã—Ö
        function getItemClass(dataType) {
            if (!dataType) return '';
            
            const type = String(dataType).toLowerCase();
            if (type.includes('leak') || type.includes('breach')) return 'leak-item';
            if (type.includes('social') || type.includes('contact')) return 'social-item';
            if (type.includes('financial') || type.includes('bank') || type.includes('sber')) return 'finance-item';
            return '';
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π JSON
        function formatJsonValue(key, value) {
            if (value === null || value === undefined || value === '') return null;
            
            // –ë—É–ª–µ–≤—ã –∑–Ω–∞—á–µ–Ω–∏—è
            if (typeof value === 'boolean') {
                return value ? '‚úÖ –î–∞' : '‚ùå –ù–µ—Ç';
            }
            
            // –ß–∏—Å–ª–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
            if (typeof value === 'number') {
                return key.toLowerCase().includes('sum') ? `${value} ‚ÇΩ` : String(value);
            }
            
            // –°—Ç—Ä–æ–∫–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
            if (typeof value === 'string') {
                // –î–ª–∏–Ω–Ω—ã–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –ø–æ–ª—è
                if (value.length > 100) {
                    return value.substring(0, 100) + '...';
                }
                
                // –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å—Ç—Ä–æ–∫–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
                if (value === 'ACTIVE' || value === 'Y') return '‚úÖ –ê–∫—Ç–∏–≤–µ–Ω';
                if (value === 'INACTIVE' || value === 'N') return '‚ùå –ù–µ–∞–∫—Ç–∏–≤–µ–Ω';
                if (value === 'NULL') return '‚Äî';
                
                return value;
            }
            
            // –û–±—ä–µ–∫—Ç—ã –∏ –º–∞—Å—Å–∏–≤—ã
            if (typeof value === 'object') {
                return JSON.stringify(value).substring(0, 80) + '...';
            }
            
            return String(value);
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ –º–∞—Å—Å–∏–≤–∞
        function getArrayTitle(field) {
            const titles = {
                'leaks': 'üîê –£—Ç–µ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö',
                'social_media': 'üë• –°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏',
                'financial_data': 'üí≥ –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ',
                'additional_info': 'üìã –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è'
            };
            return titles[field] || formatKey(field);
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–∞ –º–∞—Å—Å–∏–≤–∞
        function getArrayItemTitle(field) {
            const titles = {
                'leaks': '–£—Ç–µ—á–∫–∞',
                'social_media': '–ü—Ä–æ—Ñ–∏–ª—å',
                'financial_data': '–û–ø–µ—Ä–∞—Ü–∏—è',
                'additional_info': '–ó–∞–ø–∏—Å—å'
            };
            return titles[field] || '–≠–ª–µ–º–µ–Ω—Ç';
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è CORS –ø—Ä–æ–∫—Å–∏
        function getCorsProxy(url) {
            return `https://api.allorigins.win/raw?url=${encodeURIComponent(url)}`;
        }

        // –§—É–Ω–∫—Ü–∏—è –æ—á–∏—Å—Ç–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        function clearResults() {
            const resultsDiv = document.getElementById('results');
            const totalResultDiv = document.getElementById('totalResult');
            const progressBar = document.getElementById('progressBar');
            const apiCounter = document.getElementById('apiCounter');
            
            resultsDiv.innerHTML = '';
            totalResultDiv.style.display = 'none';
            progressBar.style.width = '0%';
            apiCounter.textContent = '';
        }

        // –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ –Ω–æ–º–µ—Ä–∞
        async function validatePhone() {
            if (currentSearchInProgress) return;
            
            const phoneInput = document.getElementById('phoneInput');
            const phoneNumber = phoneInput.value.trim();
            
            if (!phoneNumber) {
                alert('–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞');
                return;
            }

            clearResults();
            setButtonsState(true);
            currentSearchInProgress = true;

            let validCount = 0;
            let totalChecked = 0;
            const totalChecks = 5;
            
            const checks = [
                { name: "–§–æ—Ä–º–∞—Ç E.164", check: () => /^\+[1-9]\d{1,14}$/.test(phoneNumber) },
                { name: "–î–ª–∏–Ω–∞ –Ω–æ–º–µ—Ä–∞", check: () => phoneNumber.length >= 10 && phoneNumber.length <= 15 },
                { name: "–ö–æ–¥ —Å—Ç—Ä–∞–Ω—ã", check: () => ['+7', '+1', '+44', '+49', '+33', '+86'].some(code => phoneNumber.startsWith(code)) },
                { name: "–†–æ—Å—Å–∏–π—Å–∫–∏–π –æ–ø–µ—Ä–∞—Ç–æ—Ä", check: () => {
                    if (!phoneNumber.startsWith('+7')) return false;
                    const code = phoneNumber.substring(2, 5);
                    return ['910', '915', '916', '917', '919', '985', '986', '903', '905', '906'].includes(code);
                }},
                { name: "–í–∞–ª–∏–¥–Ω—ã–π –ø—Ä–µ—Ñ–∏–∫—Å", check: () => !phoneNumber.startsWith('+0') }
            ];
            
            for (let i = 0; i < checks.length; i++) {
                if (!currentSearchInProgress) break;
                
                const check = checks[i];
                const resultsDiv = document.getElementById('results');
                const progressBar = document.getElementById('progressBar');
                const apiCounter = document.getElementById('apiCounter');
                
                const resultItem = document.createElement('div');
                resultItem.className = 'result-item checking';
                resultItem.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <span>${check.name} <span class="service-name">–ø—Ä–æ–≤–µ—Ä–∫–∞...</span></span>
                        <span class="status">...</span>
                    </div>
                `;
                resultsDiv.appendChild(resultItem);
                
                progressBar.style.width = `${((i + 1) / totalChecks) * 100}%`;
                apiCounter.textContent = `–ü—Ä–æ–≤–µ—Ä–∫–∞ ${i + 1} –∏–∑ ${totalChecks}`;
                
                await new Promise(resolve => setTimeout(resolve, 300));
                
                try {
                    const isValid = check.check();
                    totalChecked++;
                    
                    if (isValid) {
                        validCount++;
                        resultItem.className = 'result-item valid';
                        resultItem.innerHTML = `
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <span>${check.name} <span class="service-name">‚úì –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞</span></span>
                                <span class="status">–í–ê–õ–ò–î</span>
                            </div>
                        `;
                    } else {
                        resultItem.className = 'result-item invalid';
                        resultItem.innerHTML = `
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <span>${check.name} <span class="service-name">‚úì –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞</span></span>
                                <span class="status">–ù–ï –í–ê–õ–ò–î</span>
                            </div>
                        `;
                    }
                } catch (error) {
                    resultItem.className = 'result-item error';
                    resultItem.innerHTML = `
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span>${check.name} <span class="service-name">‚úó –æ—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏</span></span>
                            <span class="status">–û–®–ò–ë–ö–ê</span>
                        </div>
                    `;
                }
            }
            
            if (totalChecked > 0 && currentSearchInProgress) {
                const validPercentage = (validCount / totalChecked) * 100;
                const totalResultDiv = document.getElementById('totalResult');
                totalResultDiv.style.display = 'block';
                
                if (validPercentage >= 60) {
                    totalResultDiv.className = 'total-result total-valid';
                    totalResultDiv.textContent = `–û–ë–©–ò–ô –†–ï–ó–£–õ–¨–¢–ê–¢: –í–ê–õ–ò–î (${validCount}/${totalChecked} –ø—Ä–æ–≤–µ—Ä–æ–∫)`;
                } else {
                    totalResultDiv.className = 'total-result total-invalid';
                    totalResultDiv.textContent = `–û–ë–©–ò–ô –†–ï–ó–£–õ–¨–¢–ê–¢: –ù–ï –í–ê–õ–ò–î (${validCount}/${totalChecked} –ø—Ä–æ–≤–µ—Ä–æ–∫)`;
                }
                
                totalResultDiv.scrollIntoView({ behavior: 'smooth' });
            }
            
            setButtonsState(false);
            currentSearchInProgress = false;
            document.getElementById('progressBar').style.width = '100%';
            document.getElementById('apiCounter').textContent = '–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞';
        }

        // –§—É–Ω–∫—Ü–∏—è –ø–æ–∏—Å–∫–∞ –ø–æ DepSearch API
        async function searchByAPI() {
            if (currentSearchInProgress) return;
            
            const phoneInput = document.getElementById('phoneInput');
            const phoneNumber = phoneInput.value.trim();
            
            if (!phoneNumber) {
                alert('–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞');
                return;
            }
            
            clearResults();
            setButtonsState(true);
            currentSearchInProgress = true;

            const resultsDiv = document.getElementById('results');
            const progressBar = document.getElementById('progressBar');
            const apiCounter = document.getElementById('apiCounter');
            
            const loadingItem = document.createElement('div');
            loadingItem.className = 'result-item checking';
            loadingItem.innerHTML = `
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <span>${DEPSEARCH_API.name} <span class="service-name">–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É...</span></span>
                    <span class="status">...</span>
                </div>
            `;
            resultsDiv.appendChild(loadingItem);
            
            try {
                progressBar.style.width = '30%';
                apiCounter.textContent = '–ó–∞–ø—Ä–æ—Å –∫ DepSearch API...';
                
                const timeoutPromise = new Promise((_, reject) => 
                    setTimeout(() => reject(new Error('–¢–∞–π–º–∞—É—Ç –∑–∞–ø—Ä–æ—Å–∞: —Å–µ—Ä–≤–µ—Ä –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç')), 10000)
                );
                
                const fetchPromise = fetch(DEPSEARCH_API.url(phoneNumber));
                const response = await Promise.race([fetchPromise, timeoutPromise]);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                progressBar.style.width = '70%';
                apiCounter.textContent = '–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö...';
                
                const data = await response.json();
                
                progressBar.style.width = '100%';
                apiCounter.textContent = '–î–∞–Ω–Ω—ã–µ –ø–æ–ª—É—á–µ–Ω—ã';
                
                if (currentSearchInProgress) {
                    loadingItem.className = 'api-result';
                    loadingItem.innerHTML = renderDepSearchData(data);
                }
                
            } catch (error) {
                if (currentSearchInProgress) {
                    loadingItem.className = 'result-item error';
                    loadingItem.innerHTML = `
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span>${DEPSEARCH_API.name} <span class="service-name">‚úó –æ—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è</span></span>
                            <span class="status">–û–®–ò–ë–ö–ê</span>
                        </div>
                        <div style="margin-top: 10px; color: #FFC107; font-size: 0.9rem;">
                            ${error.message}
                        </div>
                    `;
                }
            }
            
            setButtonsState(false);
            currentSearchInProgress = false;
        }

        // –§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ç—Ä–æ–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
        function createInfoLine(label, value) {
            return `
                <div class="info-line">
                    <span class="info-label">${label}:</span>
                    <span class="info-value">${value || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</span>
                </div>
            `;
        }

        // –§—É–Ω–∫—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–ª—é—á–µ–π –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
        function formatKey(key) {
            const formatted = key.replace(/\./g, ' ')
                               .replace(/([A-Z])/g, ' $1')
                               .replace(/_/g, ' ')
                               .replace(/\b\w/g, l => l.toUpperCase())
                               .trim();
            
            return formatted;
        }

        // –§—É–Ω–∫—Ü–∏—è –ø–æ–∏—Å–∫–∞ –ø–æ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–º API
        async function searchByFreeAPI() {
            if (currentSearchInProgress) return;
            
            const phoneInput = document.getElementById('phoneInput');
            const phoneNumber = phoneInput.value.trim();
            
            if (!phoneNumber) {
                alert('–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞');
                return;
            }
            
            clearResults();
            setButtonsState(true);
            currentSearchInProgress = true;

            const resultsDiv = document.getElementById('results');
            const progressBar = document.getElementById('progressBar');
            const apiCounter = document.getElementById('apiCounter');
            
            const totalApis = FREE_PHONE_APIS.length;
            let completedApis = 0;
            let successfulApis = 0;
            
            for (let i = 0; i < FREE_PHONE_APIS.length; i++) {
                if (!currentSearchInProgress) break;
                
                const api = FREE_PHONE_APIS[i];
                
                const resultItem = document.createElement('div');
                resultItem.className = 'result-item checking';
                resultItem.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <span>${api.name} <span class="service-name">–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...</span></span>
                        <span class="status">...</span>
                    </div>
                `;
                resultsDiv.appendChild(resultItem);
                
                completedApis++;
                progressBar.style.width = `${(completedApis / totalApis) * 100}%`;
                apiCounter.textContent = `API ${completedApis} –∏–∑ ${totalApis} (–£—Å–ø–µ—à–Ω–æ: ${successfulApis})`;
                
                try {
                    const response = await fetch(getCorsProxy(api.url(phoneNumber)));
                    
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    
                    const data = await response.json();
                    const processedData = api.process(data);
                    
                    successfulApis++;
                    
                    if (currentSearchInProgress) {
                        resultItem.className = 'api-result';
                        resultItem.innerHTML = `
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                <span style="font-weight: bold; font-size: 1.1rem;">${api.name}</span>
                                <span class="status" style="color: #4CAF50;">–£–°–ü–ï–•</span>
                            </div>
                            <div class="result-data">
                                ${Object.entries(processedData).map(([key, value]) => createInfoLine(formatKey(key), value)).join('')}
                            </div>
                        `;
                    }
                    
                } catch (error) {
                    if (currentSearchInProgress) {
                        resultItem.className = 'result-item error';
                        resultItem.innerHTML = `
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <span>${api.name} <span class="service-name">‚úó –æ—à–∏–±–∫–∞ API</span></span>
                                <span class="status">–û–®–ò–ë–ö–ê</span>
                            </div>
                            <div style="margin-top: 10px; color: #FFC107; font-size: 0.9rem;">
                                ${error.message}
                            </div>
                        `;
                    }
                }
                
                await new Promise(resolve => setTimeout(resolve, 800));
            }
            
            setButtonsState(false);
            currentSearchInProgress = false;
            apiCounter.textContent = `–ó–∞–≤–µ—Ä—à–µ–Ω–æ: ${completedApis} API (–£—Å–ø–µ—à–Ω–æ: ${successfulApis})`;
        }

        function setButtonsState(disabled) {
            const buttons = ['searchBtn', 'printBtn', 'downloadBtn'];
            buttons.forEach(id => {
                const btn = document.getElementById(id);
                btn.disabled = disabled;
            });
            document.getElementById('searchBtn').textContent = disabled ? '–ü–û–î–ö–õ–Æ–ß–ï–ù–ò–ï...' : '–ü–†–û–í–ï–†–ò–¢–¨';
        }

        // –§—É–Ω–∫—Ü–∏—è –ø–µ—á–∞—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        function printResults() {
            window.print();
        }

        // –§—É–Ω–∫—Ü–∏—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ TXT
        function downloadResults() {
            const resultsDiv = document.getElementById('results');
            const phoneInput = document.getElementById('phoneInput');
            const phoneNumber = phoneInput.value.trim();
            
            if (!phoneNumber) {
                alert('–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –ø–æ–∏—Å–∫');
                return;
            }
            
            let content = "–í–µ—á–Ω–∞—è —Å—Å—ã–ª–∫–∞: FaidikSearch.xyz\n\n";
            content += `–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ –¥–ª—è –Ω–æ–º–µ—Ä–∞: ${phoneNumber}\n`;
            content += `–¢–∏–ø –ø–æ–∏—Å–∫–∞: ${getSearchTypeName(currentSearchType)}\n`;
            content += `–î–∞—Ç–∞: ${new Date().toLocaleString()}\n\n`;
            
            const resultItems = resultsDiv.querySelectorAll('.result-item, .api-result');
            
            if (resultItems.length === 0) {
                content += "–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è\n";
            } else {
                resultItems.forEach(item => {
                    const text = item.textContent.replace(/\s+/g, ' ').trim();
                    content += text + "\n\n";
                });
            }
            
            content += "\n–í–µ—á–Ω–∞—è —Å—Å—ã–ª–∫–∞: FaidikSearch.xyz";
            
            const blob = new Blob([content], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `FaidikApp_${phoneNumber}_${new Date().toISOString().slice(0, 10)}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function getSearchTypeName(type) {
            const names = {
                'validity': '–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –≤–∞–ª–∏–¥',
                'api': '–ü–æ–∏—Å–∫ –ø–æ API', 
                'freeapi': '–ü–æ–∏—Å–∫ –ø–æ FREEAPI'
            };
            return names[type] || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–∏–ø';
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', () => {
            document.querySelectorAll('.search-type-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    currentSearchInProgress = false;
                    
                    document.querySelectorAll('.search-type-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentSearchType = this.getAttribute('data-type');
                    
                    clearResults();
                });
            });
            
            document.getElementById('searchBtn').addEventListener('click', function() {
                switch(currentSearchType) {
                    case 'validity': validatePhone(); break;
                    case 'api': searchByAPI(); break;
                    case 'freeapi': searchByFreeAPI(); break;
                }
            });
            
            document.getElementById('phoneInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') document.getElementById('searchBtn').click();
            });
            
            document.getElementById('printBtn').addEventListener('click', printResults);
            document.getElementById('downloadBtn').addEventListener('click', downloadResults);
            
            document.getElementById('phoneInput').value = '+79161234567';
        });
    </script>
</body>
</html>